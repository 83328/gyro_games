<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gyro Games</title>
  <style>
  body{font-family:Arial,Helvetica,sans-serif;background:#0b1220;color:#e6f0ff;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;min-height:100vh;margin:0;padding-top:18px;overflow:auto}
    .card{background:#0f1724;padding:20px;border-radius:8px;border:1px solid #223;background-clip:padding-box;box-shadow:0 6px 18px rgba(0,0,0,0.6);width:320px;max-width:90%}
    h1{margin:0 0 12px 0;font-size:20px}
    a.btn{display:block;text-decoration:none;padding:10px 12px;margin:8px 0;background:#1f6feb;color:#fff;border-radius:6px;text-align:center}
    a.btn.secondary{background:#ff6b6b}
    p.small{font-size:12px;color:#a8b4d6;margin:8px 0 0}
   /* thumbnail sizing: keep a max ratio of 4:3 by making the thumb container 4:3
     and letting the image cover the box. This prevents very wide images on desktop. */
  .thumb{ display:block; aspect-ratio: 4 / 3; overflow:hidden; border-radius:6px; background:#0b0b0b; position:relative; min-height:120px }
  .thumb img.thumb-img{ width:100%; height:100%; object-fit:cover; object-position:center center; display:block }
  /* overlay label on image */
  .thumb .overlay{ position:absolute; left:0; right:0; bottom:0; padding:8px 10px; color:#eef; font-weight:600; text-align:center; background:linear-gradient(rgba(0,0,0,0.0), rgba(0,0,0,0.6)); }
  @media(min-width:900px){ .card { width:560px } .thumb-grid{ grid-template-columns: repeat(3, 1fr); gap:8px } }
  </style>
</head>
<body>
  <!-- Room ID display -->
  <div class="card" style="text-align:center; margin-bottom:10px;">
    <div style="font-size:18px; font-weight:600; color:#ffd86b; letter-spacing:2px;">Room ID: <span id="roomIdDisplay"></span></div>
  </div>
  <div class="card" style="text-align:center">
    <div style="display:flex;gap:8px;align-items:center;justify-content:center;flex-direction:column">
      <img id="qrImg" alt="QR code" style="width:200px;height:200px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:#fff" src="" />
      <div style="display:flex;gap:8px;margin-top:8px;align-items:center">
        <label style="font-size:13px"><input id="useRoot" type="checkbox" checked style="margin-right:6px"/> Use root URL</label>
        <button id="copyLink" class="btn" style="padding:.4rem .6rem">Copy link</button>
      </div>
      <div style="font-size:12px;color:#a8b4d6;margin-top:6px">Scan to open this page on your phone</div>
    </div>
  </div>
  <div class="card">
    <h1>Games</h1>
    <div class="thumb-grid" style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px">
  <a class="thumb" href="/maze.html" title="Maze Runner"><img class="thumb-img" src="/media/images/thumb_maze.png" alt="Maze Runner thumbnail"/><div class="overlay">Maze Runner</div></a>
  <a class="thumb" href="/blob.html" title="Blob Eaters"><img class="thumb-img" src="/media/images/thumb_blob.png" alt="Blob Eaters thumbnail"/><div class="overlay">Blob Eaters</div></a>
  <a class="thumb" href="/lander.html" title="Lander"><img class="thumb-img" src="/media/images/thumb_lander.png" alt="Lander thumbnail"/><div class="overlay">Lander</div></a>
  <a class="thumb" href="/sumo.html" title="Gyro Sumo"><img class="thumb-img" src="/media/images/thumb_sumo.png" alt="Gyro Sumo thumbnail"/><div class="overlay">Gyro Sumo</div></a>
  <a class="thumb" href="/turtle.html" title="Turtle Race"><img class="thumb-img" src="/media/images/thumb_turtle.png" alt="Turtle Race thumbnail"/><div class="overlay">Turtle Race</div></a>
  <a class="thumb" href="/paint.html" title="Paint"><img class="thumb-img" src="/media/images/thumb_paint.png" alt="Paint thumbnail"/><div class="overlay">Paint</div></a>
  <a class="thumb" href="/sweepers.html" title="Asteroid Sweepers"><img class="thumb-img" src="/media/images/thumb_sweepers.png" alt="Asteroid Sweepers thumbnail"/><div class="overlay">Asteroid Sweepers</div></a>
  <a class="thumb" href="/pong.html" title="Pong"><img class="thumb-img" src="/media/images/thumb_pong.png" alt="Pong thumbnail"/><div class="overlay">Pong</div></a>
  <a class="thumb" href="/blackhole.html" title="Blackhole Blaster"><img class="thumb-img" src="/media/images/thumb_blackhole.png" alt="Blackhole Blaster thumbnail"/><div class="overlay">Blackhole Blaster</div></a>
    </div>
  </div>
</body>
<script>
  // Generate a random three-letter room code
  function randomRoomCode() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    let code = '';
    for (let i = 0; i < 3; ++i) code += chars[Math.floor(Math.random() * chars.length)];
    return code;
  }
  const roomCode = randomRoomCode();
  // Show room code in the page
  document.addEventListener('DOMContentLoaded', function() {
    const roomIdDisplay = document.getElementById('roomIdDisplay');
    if (roomIdDisplay) roomIdDisplay.textContent = roomCode;
  });

  const qrImg = document.getElementById('qrImg');
  const useRoot = document.getElementById('useRoot');
  const copyBtn = document.getElementById('copyLink');

  // Build a URL to the streaming page with ?room=ROOMCODE
  function buildUrl(){
    return `${location.protocol}//${location.host}/gyro.html?room=${roomCode}`;
  }
  function updateGameLinks() {
    const links = document.querySelectorAll('.thumb-grid a');
    links.forEach(link => {
      const url = new URL(link.getAttribute('href'), location.origin);
      url.searchParams.set('room', roomCode);
      link.setAttribute('href', url.pathname + url.search);
    });
  }
  updateGameLinks();
  function updateQr(){
    const u = buildUrl();
    // api.qrserver.com generates a PNG for free and supports size param
    const src = `https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${encodeURIComponent(u)}`;
    qrImg.src = src;
    qrImg.title = u;
  }
  useRoot.addEventListener('change', updateQr);
  copyBtn.addEventListener('click', ()=>{ navigator.clipboard?.writeText(buildUrl()).then(()=>{ copyBtn.textContent='Copied'; setTimeout(()=>copyBtn.textContent='Copy link',1200); }); });
  updateQr();
</script>
</html>
